===========================================================
Database User Administrator 
===========================================================

CREATE TABLE [dbo].[LES_APPLICATIONS](
	[APPLICATIONID] [int] IDENTITY(1,1) NOT NULL,
	[APPLICATION_NAME] [nvarchar](100) NULL,
 CONSTRAINT [PK_LES_APPLICATIONS] PRIMARY KEY CLUSTERED 
(
	[APPLICATIONID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


CREATE TABLE [dbo].[LES_COMPANY](
	[COMPANYID] [int]  NOT NULL,
	[COMPANY_CODE] [nvarchar](50) NOT NULL,
	[COMPANY_DESCRIPTION] [nvarchar](255) NOT NULL,
	[CREATED_DATE] [date] NULL,
	[UPDATED_DATE] [date] NULL,
	[LOGOPATH] [nvarchar](50) NULL,
	[ADDRESSID] [int] NOT NULL,
 CONSTRAINT [PK_MAST_COMPANY] PRIMARY KEY CLUSTERED 
(
	[COMPANYID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


CREATE TABLE [dbo].[LES_MODULE](
	[MODULEID] [int] NOT NULL,
	[APPLICATIONID] [int] NOT NULL,
	[MODULE_CODE] [nvarchar](50) NULL,
	[MODULE_DESC] [nvarchar](200) NULL,
 CONSTRAINT [PK_MODULE] PRIMARY KEY CLUSTERED 
(
	[MODULEID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[LES_MODULE]  WITH CHECK ADD  CONSTRAINT [FK_LES_MODULE_LES_APPLICATIONS] FOREIGN KEY([APPLICATIONID])
REFERENCES [dbo].[LES_APPLICATIONS] ([APPLICATIONID])
GO

ALTER TABLE [dbo].[LES_MODULE] CHECK CONSTRAINT [FK_LES_MODULE_LES_APPLICATIONS]
GO

CREATE TABLE [dbo].[LES_USER_COMPANY_LINK](
	[USER_COMPANY_LINK_ID] [int] IDENTITY(1,1) NOT NULL,
	[EX_USERID] [int] NULL,
	[COMPANYID] [int] NULL,
	[USERTYPEID] [int] NULL,
	[CREATED_DATE] [datetime] NULL,
	[CREATED_BY] [int] NULL,
 CONSTRAINT [PK_LES_USER_COMPANY_LINK] PRIMARY KEY CLUSTERED 
(
	[USER_COMPANY_LINK_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[LES_USER_COMPANY_LINK]  WITH CHECK ADD  CONSTRAINT [FK_LES_USER_COMPANY_LINK_LES_COMPANY] FOREIGN KEY([COMPANYID])
REFERENCES [dbo].[LES_COMPANY] ([COMPANYID])
GO

ALTER TABLE [dbo].[LES_USER_COMPANY_LINK] CHECK CONSTRAINT [FK_LES_USER_COMPANY_LINK_LES_COMPANY]
GO

ALTER TABLE [dbo].[LES_USER_COMPANY_LINK]  WITH CHECK ADD  CONSTRAINT [FK_LES_USER_COMPANY_LINK_SM_EXTERNAL_USERS] FOREIGN KEY([EX_USERID])
REFERENCES [dbo].[SM_EXTERNAL_USERS] ([EX_USERID])
GO

ALTER TABLE [dbo].[LES_USER_COMPANY_LINK] CHECK CONSTRAINT [FK_LES_USER_COMPANY_LINK_SM_EXTERNAL_USERS]
GO


CREATE TABLE [dbo].[LES_USERTYPE](
	[USERTYPEID] [int] IDENTITY(1,1) NOT NULL,
	[USERTYPEDESCR] [nvarchar](50) NULL,
	[USERTYPE_LEVEL] [int] NULL,
	[UPDATE_DATE] [datetime] NULL,
	[CREATED_DATE] [datetime] NULL,
 CONSTRAINT [PK_LES_USERTYPE] PRIMARY KEY NONCLUSTERED 
(
	[USERTYPEID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


CREATE VIEW [dbo].[V_APPLICATION_MODULE_ACCESS]
AS
SELECT dbo.LES_MODULE.MODULEID, dbo.LES_MODULE.APPLICATIONID, dbo.LES_MODULE.MODULE_CODE, dbo.LES_MODULE.MODULE_DESC, dbo.LES_USERTYPE_MODULE_ACCESS.MODULEACCESSID, 
                  dbo.LES_USERTYPE_MODULE_ACCESS.USERTYPEID, dbo.LES_USERTYPE_MODULE_ACCESS.ACCESS_LEVEL, dbo.LES_USERTYPE.USERTYPEDESCR, dbo.LES_USER_COMPANY_LINK.EX_USERID, 
                  dbo.LES_USER_COMPANY_LINK.COMPANYID, dbo.LES_USER_COMPANY_LINK.USER_COMPANY_LINK_ID, dbo.LES_APPLICATIONS.APPLICATION_NAME
FROM     dbo.LES_MODULE INNER JOIN
                  dbo.LES_USERTYPE_MODULE_ACCESS ON dbo.LES_MODULE.MODULEID = dbo.LES_USERTYPE_MODULE_ACCESS.MODULEID INNER JOIN
                  dbo.LES_USERTYPE ON dbo.LES_USERTYPE_MODULE_ACCESS.USERTYPEID = dbo.LES_USERTYPE.USERTYPEID INNER JOIN
                  dbo.LES_USER_COMPANY_LINK ON dbo.LES_USERTYPE.USERTYPEID = dbo.LES_USER_COMPANY_LINK.USERTYPEID LEFT OUTER JOIN
                  dbo.LES_APPLICATIONS ON dbo.LES_MODULE.APPLICATIONID = dbo.LES_APPLICATIONS.APPLICATIONID
GO

CREATE VIEW [dbo].[V_COMPANY_DETAILS]
AS
SELECT dbo.LES_COMPANY.COMPANY_CODE, dbo.LES_COMPANY.COMPANYID, dbo.LES_COMPANY.COMPANY_DESCRIPTION, dbo.LES_COMPANY.LOGOPATH, dbo.LES_COMPANY.ADDRESSID, dbo.LES_USER_COMPANY_LINK.EX_USERID, 
                  dbo.LES_USER_COMPANY_LINK.USERTYPEID, dbo.LES_USERTYPE.USERTYPEDESCR, dbo.LES_USER_COMPANY_LINK.USER_COMPANY_LINK_ID
FROM     dbo.LES_COMPANY INNER JOIN
                  dbo.LES_USER_COMPANY_LINK ON dbo.LES_COMPANY.COMPANYID = dbo.LES_USER_COMPANY_LINK.COMPANYID INNER JOIN
                  dbo.LES_USERTYPE ON dbo.LES_USER_COMPANY_LINK.USERTYPEID = dbo.LES_USERTYPE.USERTYPEID
GO

===========================================================
Database Logistic 
===========================================================
CREATE TABLE [dbo].[SHIPMENT](
	[SHIPMENTID] [int] IDENTITY(1,1) NOT NULL,
	[ORDER_NO] [nvarchar](50) NULL,
	[ORDER_ID] [int] NULL,
	[SENDERID] [int] NULL,
	[RECEIVERID] [int] NULL,
	[SITEID] [int] NULL,
	[PLANNED_SHIP_DATE] [datetime] NULL,
	[PLANNED_DELIVERY_DATE] [datetime] NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[SHIPMENT_NOTES] [nvarchar](max) NULL,
	[REFERENCE_TYPE] [nvarchar](50) NULL,
	[SHIPMENT_TYPE] [nvarchar](50) NULL,
	[NEXT_STEP_SHIPMENT] [nvarchar](100) NULL,
	[AUTOCONNECTION_BLOCKED] [int] NULL,
	[SHIPMENT_STATUSID] [int] NULL,
	[SHIPMENTTYPE_ID] [int] NULL,
	[Is_Delete] [int] NULL,
	[ISAUTO] [int] NULL,
	[JOBNO] [nvarchar](50) NULL,
	[COMPANYID] [int] NULL,
	[CREATED_BY] [int] NULL,
	[UPDATED_BY] [int] NULL,
 CONSTRAINT [PK_SHIPMENT] PRIMARY KEY CLUSTERED 
(
	[SHIPMENTID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO

========================================
CREATE TABLE [dbo].[SHIPMENT_DOCUMENTS](
	[SHIPMENT_DOCUMENT_ID] [int] IDENTITY(1,1) NOT NULL,
	[DOCUMENT_NO] [int] NULL,
	[DOCUMENT_TYPE] [nvarchar](20) NULL,
	[DOCUMENT_NAME] [nvarchar](200) NULL,
	[DOCUMENT_TITLE] [nvarchar](20) NULL,
	[DOCUMENT_PATH] [nvarchar](500) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[SHIPMENTID] [int] NULL,
	[IS_DELETE] [int] NULL,
	[CREATED_BY] [int] NULL,
	[UPDATED_BY] [int] NULL,
 CONSTRAINT [PK_SHIPMENT_DOCUMENTS] PRIMARY KEY CLUSTERED 
(
	[SHIPMENT_DOCUMENT_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

========================================
CREATE TABLE [dbo].[SHIPMENT_VESSEL_INFO](
	[SHIPMENT_VESSEL_INFO_ID] [int] IDENTITY(1,1) NOT NULL,
	[SHIPMENTID] [int] NULL,
	[VESSEL_ID] [int] NULL,
	[VESSEL_ETA] [datetime] NULL,
	[VESSEL_ATA] [datetime] NULL,
	[DELIVERY_DATE] [datetime] NULL,
	[ANCHORAGE_ID] [int] NULL,
	[AGENT] [nvarchar](100) NULL,
	[AGENT_CONTACT_PERSON] [nvarchar](100) NULL,
	[AGENT_CONTACT_NO] [nvarchar](50) NULL,
	[SUPPLY_BOAT] [nvarchar](100) NULL,
	[SUPPLY_BOAT_CONTACT_PERSON] [nvarchar](100) NULL,
	[SUPPLY_BOAT_CONTACT_NO] [nvarchar](50) NULL,
	[LOADING_POINT] [nvarchar](200) NULL,
	[LOADING_TIME] [datetime] NULL,
	[CO_PARTY] [nvarchar](100) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[CREATED_BY] [int] NULL,
	[UPDATED_BY] [int] NULL,
	[EPOD_SHIPMENT_NOTES] [nvarchar](100) NULL,
 CONSTRAINT [PK_SHIPMENT_VESSEL_INFO] PRIMARY KEY CLUSTERED 
(
	[SHIPMENT_VESSEL_INFO_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

========================================
CREATE TABLE [dbo].[DELIVERY_ORDERS](
	[DELIVERY_ORDER_ID] [int] IDENTITY(10001,1) NOT NULL,
	[DELIVERY_ORDER_NO] [nvarchar](50) NULL,
	[SHIPMENTID] [int] NULL,
	[SITEID] [int] NULL,
	[TRIPDETAILID] [int] NULL,
	[TRIPID] [int] NULL,
	[REMARKS] [nvarchar](500) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATE_DATE] [datetime] NULL,
	[DELIVERY_DATE] [datetime] NULL,
	[STATUSID] [int] NULL,
	[Is_Delete] [int] NULL,
	[CUSTOMERID] [int] NULL,
	[END_CUSTOMERID] [int] NULL,
	[Dispatched_Advise_Sent] [int] NULL,
	[EPOD_STATUS] [int] NULL,
	[PLANNED_FROM] [datetime] NULL,
	[PLANNED_TO] [datetime] NULL,
	[ACTUAL_START] [datetime] NULL,
	[ACTUAL_END] [datetime] NULL,
	[ORDERID] [int] NULL,
	[ISAUTO] [int] NULL,
	[SMS_INDICATOR] [int] NULL,
	[WHATSAPP_INDICATOR] [int] NULL,
	[INSTRUCTIONS] [nvarchar](250) NULL,
	[DO_Complete_Date] [datetime] NULL,
	[BILLTYPE] [int] NULL,
	[EXPORTED] [int] NULL,
	[COMPANYID] [int] NULL,
 CONSTRAINT [PK_DOCUMENT_ORDERS] PRIMARY KEY CLUSTERED 
(
	[DELIVERY_ORDER_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[DELIVERY_ORDERS]  WITH CHECK ADD FOREIGN KEY([SHIPMENTID])
REFERENCES [dbo].[SHIPMENT] ([SHIPMENTID])
GO

ALTER TABLE [dbo].[DELIVERY_ORDERS]  WITH CHECK ADD FOREIGN KEY([SITEID])
REFERENCES [dbo].[Mast_Site] ([SiteId])
GO

ALTER TABLE [dbo].[DELIVERY_ORDERS]  WITH CHECK ADD  CONSTRAINT [FK__DELIVERY___TRIPD__361203C5] FOREIGN KEY([TRIPDETAILID])
REFERENCES [dbo].[Vehicle_Trip_Details] ([TRIPDETAILID])
GO

ALTER TABLE [dbo].[DELIVERY_ORDERS] CHECK CONSTRAINT [FK__DELIVERY___TRIPD__361203C5]
GO

ALTER TABLE [dbo].[DELIVERY_ORDERS]  WITH CHECK ADD FOREIGN KEY([TRIPID])
REFERENCES [dbo].[Vehicle_Trip_Planning] ([TRIPID])
GO


========================================
CREATE TABLE [dbo].[DELIVERY_ORDER_DOCUMENTS](
	[Delivery_Document_ID] [int] IDENTITY(10001,1) NOT NULL,
	[Document_No] [int] NULL,
	[Document_Type] [nvarchar](20) NULL,
	[Document_Name] [nvarchar](200) NULL,
	[Document_Title] [nvarchar](20) NULL,
	[Document_Path] [nvarchar](500) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[DELIVERY_ORDER_ID] [int] NULL,
	[Is_Delete] [int] NULL,
 CONSTRAINT [PK_DELIVERY_DOCUMENTS] PRIMARY KEY CLUSTERED 
(
	[Delivery_Document_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

========================================

CREATE TABLE [dbo].[DELIVERY_ORDER_LINES](
	[DELIVERY_ORDER_LINES_ID] [int] IDENTITY(1,1) NOT NULL,
	[ITEM_NO] [int] NULL,
	[ITEM_REF_NO] [nvarchar](50) NULL,
	[ITEM_DESCRIPTION] [nvarchar](250) NULL,
	[QUANTITY] [float] NULL,
	[UOM] [nvarchar](50) NULL,
	[AWB_BL] [nvarchar](100) NULL,
	[QUANTITY_INVOICED] [float] NULL,
	[STATUSID] [int] NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[CREATED_BY] [int] NULL,
	[UPDATED_BY] [int] NULL,
	[GRN_REASON_ID] [int] NULL,
	[DELIVERY_ORDER_ID] [int] NOT NULL,
	[BROKER_CODE] [nvarchar](100) NULL,
	[EPOD_LINE_REMARKS] [nvarchar](500) NULL,
 CONSTRAINT [PK_DELIVERY_ORDER_LINES] PRIMARY KEY CLUSTERED 
(
	[DELIVERY_ORDER_LINES_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[DELIVERY_ORDER_LINES]  WITH CHECK ADD  CONSTRAINT [FK_DELIVERY_ORDER_LINES_MAST_GOODS_RETURN_REASONS] FOREIGN KEY([GRN_REASON_ID])
REFERENCES [dbo].[MAST_GOODS_RETURN_REASONS] ([GRN_REASON_ID])
GO

ALTER TABLE [dbo].[DELIVERY_ORDER_LINES] CHECK CONSTRAINT [FK_DELIVERY_ORDER_LINES_MAST_GOODS_RETURN_REASONS]
GO
========================================
CREATE TABLE [dbo].[MAST_ANCHORAGE](
	[ANCHORAGE_ID] [int] NOT NULL,
	[ANCHORAGE_CODE] [nvarchar](50) NULL,
	[ANCHORAGE_DESCRIPTION] [nvarchar](250) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[CREATED_BY] [datetime] NULL,
	[UPDATED_BY] [datetime] NULL,
 CONSTRAINT [PK_MAST_ANCHORAGE] PRIMARY KEY CLUSTERED 
(
	[ANCHORAGE_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
=======================================

CREATE TABLE [dbo].[MAST_GOODS_RETURN_REASONS](
	[GRN_REASON_ID] [int] IDENTITY(1,1) NOT NULL,
	[GRN_REASON_CODE] [nvarchar](50) NULL,
	[GRN_REASON_DESCRIPTION] [nvarchar](500) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[CREATED_BY] [int] NULL,
	[UPDATED_BY] [int] NULL,
 CONSTRAINT [PK_MAST_GOODS_RETURN_REASONS] PRIMARY KEY CLUSTERED 
(
	[GRN_REASON_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
========================================

CREATE TABLE [dbo].[MAST_VESSEL](
	[VESSEL_ID] [int] NOT NULL,
	[VESSEL_CODE] [nvarchar](50) NULL,
	[VESSEL_NAME] [nvarchar](250) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[CREATED_BY] [int] NULL,
	[UPDATED_BY] [int] NULL,
	[IMO_NO] [int] NULL,
 CONSTRAINT [PK_MAST_VESSEL] PRIMARY KEY CLUSTERED 
(
	[VESSEL_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

--Drop table LeS_VESSEL_MASTER

========================================


========================================
CREATE TABLE [dbo].[MAST_TRANSPORT_TYPE](
	[TRANSPORT_TYPE_ID] [int] IDENTITY(1,1) NOT NULL,
	[TRANSPORT_TYPE_CODE] [nvarchar](50) NULL,
	[TRANSPORT_TYPE_DESCRIPTION] [nvarchar](200) NULL,
 CONSTRAINT [PK_MAST_TRANSPORT_TYPE] PRIMARY KEY CLUSTERED 
(
	[TRANSPORT_TYPE_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

========================================
CREATE TABLE [dbo].[Mast_TRAILER_TYPES](
	[TRAILER_TYPEID] [int] IDENTITY(1,1) NOT NULL,
	[TRAILER_TYPE] [varchar](255) NULL,
	[DESCRIPTION] [nvarchar](255) NULL,
	[UPDATED_DATE] [datetime] NULL,
	[CREATED_DATE] [datetime] NULL,
 CONSTRAINT [PK_Mast_TRAILER_TYPES] PRIMARY KEY CLUSTERED 
(
	[TRAILER_TYPEID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


CREATE TABLE [dbo].[Vehicle_Trip_Details](
	[TRIPDETAILID] [int] IDENTITY(1,1) NOT NULL,
	[TRIPID] [int] NULL,
	[TRIP_PLAN_NO] [int] NULL,
	[STATUSID] [int] NULL,
	[LOT] [varchar](50) NULL,
	[LOCATION_FROM] [varchar](100) NULL,
	[LOCATION_TO] [varchar](100) NULL,
	[ETA_ETD] [datetime] NULL,
	[PERMIT] [varchar](50) NULL,
	[VehicleTypeId] [int] NULL,
	[B_LCUTOFF] [date] NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[VESSEL] [varchar](50) NULL,
	[REMARKS] [varchar](255) NULL,
	[BKG_REF] [varchar](100) NULL,
	[ASSIGNED_DRIVER] [int] NULL,
	[SERVICE_TYPE] [varchar](50) NULL,
	[COMMISSION_CALCULATED] [int] NULL,
	[Tonnage] [float] NULL,
	[TO_DO_DATE] [datetime] NULL,
	[Is_Delete] [int] NULL,
	[FROMLOCATION_ID] [int] NULL,
	[TOLOCATION_ID] [int] NULL,
	[controller] [int] NULL,
	[VEHICLE_TONNAGEID] [int] NULL,
	[EXPORTED] [int] NULL,
	[Reject_Return_Link_Record_ID] [int] NULL,
	[DRIVER_COMMISSION_ID] [int] NULL,
	[DRIVER_COMM_PROPOSAL_ITEMID] [int] NULL,
	[TRANSPORT_TYPE_ID] [int] NULL,
	[BOARDING_OFFICER_NAME] [nvarchar](100) NULL,
	[TRANSPORT_COMPANY] [nvarchar](100) NULL,
	[ESTIMATE_PACKAGING_UNIT] [float] NULL,
	[CTM] [float] NULL,
	[ACTUAL_DELIVERY_START] [datetime] NULL,
	[ACTUAL_DELIVERY_END] [datetime] NULL,
 CONSTRAINT [PK_Vehicle_Trip_ContractDetails] PRIMARY KEY CLUSTERED 
(
	[TRIPDETAILID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

REATE TABLE [dbo].[Vehicle_Trip_Planning](
	[TRIPID] [int] IDENTITY(1,1) NOT NULL,
	[SHIPMENTID] [int] NULL,
	[STATUSID] [int] NULL,
	[POINT_TYPEID] [int] NULL,
	[CUSTOMERID] [int] NULL,
	[SITEID] [int] NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[Is_Delete] [int] NULL,
	[ORDERID] [int] NULL,
	[PLANNED_DELIVERY_DATE] [datetime] NULL,
	[SOURCE_REFTYPE] [nvarchar](20) NULL,
	[Is_Billed] [int] NULL,
	[EXPORTED] [int] NULL,
 CONSTRAINT [PK_Vehicle_Trip_Planning] PRIMARY KEY CLUSTERED 
(
	[TRIPID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[Vehicle_Trip_Planning]  WITH CHECK ADD  CONSTRAINT [FK_Vehicle_Trip_Planning_Customers] FOREIGN KEY([CUSTOMERID])
REFERENCES [dbo].[LES_CUSTOMERS] ([CUSTOMERID])

ALTER TABLE [dbo].[Vehicle_Trip_Planning]  WITH CHECK ADD  CONSTRAINT [FK_Vehicle_Trip_Planning_Mast_STATUSES] FOREIGN KEY([STATUSID])
REFERENCES [dbo].[Mast_STATUSES] ([STATUSID])
GO

ALTER TABLE [dbo].[Vehicle_Trip_Planning] CHECK CONSTRAINT [FK_Vehicle_Trip_Planning_Mast_STATUSES]

ALTER TABLE [dbo].[Vehicle_Trip_Planning]  WITH CHECK ADD  CONSTRAINT [FK_Vehicle_Trip_Planning_SHIPMENT] FOREIGN KEY([SHIPMENTID])
REFERENCES [dbo].[SHIPMENT] ([SHIPMENTID])
GO

ALTER TABLE [dbo].[Vehicle_Trip_Planning] CHECK CONSTRAINT [FK_Vehicle_Trip_Planning_SHIPMENT]
GO

ALTER TABLE [dbo].[Vehicle_Trip_Details]  WITH CHECK ADD  CONSTRAINT [FK_Vehicle_Trip_Details_Vehicle_Trip_Planning] FOREIGN KEY([TRIPID])
REFERENCES [dbo].[Vehicle_Trip_Planning] ([TRIPID])
GO

ALTER TABLE [dbo].[Vehicle_Trip_Details]  WITH CHECK ADD  CONSTRAINT [FK_Vehicle_Trip_Details_Mast_STATUSES] FOREIGN KEY([STATUSID])
REFERENCES [dbo].[Mast_STATUSES] ([STATUSID])
GO

ALTER TABLE [dbo].[Vehicle_Trip_Details] CHECK CONSTRAINT [FK_Vehicle_Trip_Details_Mast_STATUSES]
GO

ALTER TABLE [dbo].[Vehicle_Trip_Details]  WITH CHECK ADD  CONSTRAINT [FK_Vehicle_Trip_Details_MAST_TRANSPORT_TYPE] FOREIGN KEY([TRANSPORT_TYPE_ID])
REFERENCES [dbo].[MAST_TRANSPORT_TYPE] ([TRANSPORT_TYPE_ID])
GO

ALTER TABLE [dbo].[Vehicle_Trip_Details] CHECK CONSTRAINT [FK_Vehicle_Trip_Details_MAST_TRANSPORT_TYPE]
GO


ALTER TABLE [dbo].[Vehicle_Trip_Details] CHECK CONSTRAINT [FK_Vehicle_Trip_Details_Vehicle_Trip_Planning]
GO

CREATE TABLE [dbo].[Mast_STATUSES](
	[STATUSID] [int] NOT NULL,
	[STATUS_DESC] [nvarchar](100) NULL,
 CONSTRAINT [PK_STATUSID] PRIMARY KEY CLUSTERED 
(
	[STATUSID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[Module_Status](
	[MODULE_STATUSID] [int] IDENTITY(1,1) NOT NULL,
	[STATUSID] [int] NULL,
	[MODULEID] [int] NULL,
	[STATUS_LEVEL] [int] NULL,
 CONSTRAINT [PK_Module_Status] PRIMARY KEY CLUSTERED 
(
	[MODULE_STATUSID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


CREATE TABLE [dbo].[DELIVERY_ORDER_INFO](
	[DELIVERY_ORDER_INFO_ID] [int] IDENTITY(1,1) NOT NULL,
	[DELIVERY_ORDER_ID] [int] NULL,
	[SALES_ORDER_NO] [nvarchar](50) NULL,
	[QUOTE_NO] [nvarchar](50) NULL,
	[CONTACT] [nvarchar](100) NULL,
	[VESSEL_ID] [int] NULL,
	[VESSEL_ETA] [datetime] NULL,
	[DEPT_CODE] [nvarchar](50) NULL,
	[SALES_PERSON_CODE] [nvarchar](50) NULL,
	[POSTING_DATE] [datetime] NULL,
	[REQUESTED_DELIVERY_DATE] [datetime] NULL,
	[INTERNAL_DEPT] [nvarchar](50) NULL,
	[MARK_REFERENCE_NO] [nvarchar](200) NULL,
	[PONO] [nvarchar](50) NULL,
	[CUSTOMER_NO] [nvarchar](50) NULL,
	[CUSTOMER_NAME] [nvarchar](200) NULL,
	[PARENT_CUSTOMER] [nvarchar](100) NULL,
	[PROMISED_DELIVERY_DATE] [datetime] NULL,
	[LOCATION_CODE] [nvarchar](50) NULL,
	[AGENT_SERVICE] [nvarchar](100) NULL,
	[PACKAGING_UNIT_NO] [float] NULL,
 CONSTRAINT [PK_DELIVERY_ORDER_INFO] PRIMARY KEY CLUSTERED 
(
	[DELIVERY_ORDER_INFO_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO



CREATE VIEW [dbo].[V_DELIVERY_ORDERS_INFO]
AS
SELECT dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.SHIPMENTID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDERS.TRIPID, 
                  dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, dbo.DELIVERY_ORDER_INFO.CONTACT, dbo.DELIVERY_ORDER_INFO.VESSEL_ID, dbo.DELIVERY_ORDER_INFO.VESSEL_ETA, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.POSTING_DATE, dbo.DELIVERY_ORDER_INFO.REQUESTED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.MARK_REFERENCE_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.CUSTOMER_NO, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMER_NAME, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.MAST_VESSEL.IMO_NO, dbo.SHIPMENT.JOBNO, 
                  dbo.Mast_STATUSES.STATUS_DESC, dbo.DELIVERY_ORDERS.STATUSID, dbo.SHIPMENT.ORDER_NO, dbo.DELIVERY_ORDER_INFO.PARENT_CUSTOMER, dbo.DELIVERY_ORDER_INFO.PROMISED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDERS.COMPANYID
FROM     dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO



CREATE TABLE [dbo].[Delivery_Orders_Address](
	[DeliveryOrderAddressId] [int] IDENTITY(1,1) NOT NULL,
	[DeliveryOrderId] [int] NULL,
	[ADDRESS1] [nvarchar](500) NULL,
	[ADDRESS2] [nvarchar](500) NULL,
	[ADDRESS3] [nvarchar](500) NULL,
	[ADDRESS4] [nvarchar](500) NULL,
	[ADDRESS5] [nvarchar](500) NULL,
	[ZIPCODE] [nvarchar](50) NULL,
	[CITY] [nvarchar](150) NULL,
	[STATE] [nvarchar](150) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[ADDR_TYPE] [varchar](50) NULL,
	[COUNTRYID] [int] NULL,
	[ADDR_NAME] [nvarchar](100) NULL,
	[ADDR_CODE] [nvarchar](50) NULL,
	[CONTACT_NUMBER] [nvarchar](100) NULL,
	[Is_Delete] [int] NULL,
	[CONTACT_PERSONID] [int] NULL,
	[EmailID] [nvarchar](100) NULL,
	[Contact_Person_Name] [nvarchar](100) NULL,
	[COUNTRY_REGION] [nvarchar](100) NULL,
 CONSTRAINT [PK_Delivery_Orders_Address] PRIMARY KEY CLUSTERED 
(
	[DeliveryOrderAddressId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO



ALTER TABLE [dbo].[Delivery_Orders_Address]  WITH CHECK ADD  CONSTRAINT [FK_Delivery_Orders_Address_DELIVERY_ORDERS] FOREIGN KEY([DeliveryOrderId])
REFERENCES [dbo].[DELIVERY_ORDERS] ([DELIVERY_ORDER_ID])
GO

ALTER TABLE [dbo].[Delivery_Orders_Address] CHECK CONSTRAINT [FK_Delivery_Orders_Address_DELIVERY_ORDERS]
GO


CREATE VIEW [dbo].[V_Delivery_Orders_Address_EPOD]
AS
SELECT dbo.Delivery_Orders_Address.DeliveryOrderAddressId, dbo.Delivery_Orders_Address.DeliveryOrderId, dbo.Delivery_Orders_Address.ADDRESS1, dbo.Delivery_Orders_Address.ADDRESS2, dbo.Delivery_Orders_Address.ADDRESS3, dbo.Delivery_Orders_Address.ADDRESS4, 
             dbo.Delivery_Orders_Address.ADDRESS5, dbo.Delivery_Orders_Address.ZIPCODE, dbo.Delivery_Orders_Address.CITY, dbo.Delivery_Orders_Address.STATE, dbo.Delivery_Orders_Address.CREATED_DATE, dbo.Delivery_Orders_Address.UPDATED_DATE, 
             dbo.Delivery_Orders_Address.ADDR_TYPE, dbo.Delivery_Orders_Address.COUNTRYID, dbo.Delivery_Orders_Address.ADDR_NAME, dbo.Delivery_Orders_Address.ADDR_CODE, dbo.Delivery_Orders_Address.CONTACT_NUMBER, dbo.Delivery_Orders_Address.Is_Delete, 
             dbo.Delivery_Orders_Address.CONTACT_PERSONID, dbo.Delivery_Orders_Address.EmailID, dbo.Delivery_Orders_Address.Contact_Person_Name AS CONTACT_PERSON, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.Delivery_Orders_Address.COUNTRY_REGION, 
             dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE
FROM   dbo.Delivery_Orders_Address INNER JOIN
             dbo.DELIVERY_ORDERS ON dbo.Delivery_Orders_Address.DeliveryOrderId = dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID LEFT OUTER JOIN
             dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
             dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO


CREATE VIEW [dbo].[V_DELIVERY_ORDER_DOCUMENTS]
AS
SELECT Delivery_Document_ID, Document_No, Document_Type, Document_Name, Document_Title, CREATED_DATE, UPDATED_DATE, DELIVERY_ORDER_ID, Is_Delete
FROM     dbo.DELIVERY_ORDER_DOCUMENTS
WHERE  (Is_Delete IS NULL) OR (Is_Delete <> 1)
GO


CREATE VIEW [dbo].[V_DELIVERY_ORDER_LINES]
AS
SELECT dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_LINES_ID, dbo.DELIVERY_ORDER_LINES.ITEM_NO, dbo.DELIVERY_ORDER_LINES.ITEM_REF_NO, dbo.DELIVERY_ORDER_LINES.ITEM_DESCRIPTION, dbo.DELIVERY_ORDER_LINES.QUANTITY, 
             dbo.DELIVERY_ORDER_LINES.UOM, dbo.DELIVERY_ORDER_LINES.AWB_BL, dbo.DELIVERY_ORDER_LINES.QUANTITY_INVOICED, dbo.DELIVERY_ORDER_LINES.STATUSID, dbo.DELIVERY_ORDER_LINES.CREATED_DATE, dbo.DELIVERY_ORDER_LINES.UPDATED_DATE, 
             dbo.DELIVERY_ORDER_LINES.GRN_REASON_ID, dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.SHIPMENT.JOBNO, 
             dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_LINES.BROKER_CODE, dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO
FROM   dbo.DELIVERY_ORDERS INNER JOIN
             dbo.DELIVERY_ORDER_LINES ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID LEFT OUTER JOIN
             dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID LEFT OUTER JOIN
             dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
             dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO


CREATE VIEW [dbo].[V_SHIPMENT_DELIVERY_ORDERS]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.JOBNO, Mast_STATUSES_1.STATUS_DESC AS SHIPMENT_STATUS_DESC, dbo.Mast_STATUSES.STATUS_DESC AS DO_STATUS_DESC, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, 
             dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.TRIPID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, 
             dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO
FROM   dbo.SHIPMENT INNER JOIN
             dbo.DELIVERY_ORDERS ON dbo.SHIPMENT.SHIPMENTID = dbo.DELIVERY_ORDERS.SHIPMENTID INNER JOIN
             dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
             dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
             dbo.Mast_STATUSES AS Mast_STATUSES_1 ON dbo.SHIPMENT.SHIPMENT_STATUSID = Mast_STATUSES_1.STATUSID
GO

CREATE VIEW [dbo].[V_SHIPMENT_TRIP_PLAN]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.Mast_STATUSES.STATUS_DESC, dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.Driver_Allocation.Driver_Name, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, 
             dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Vehicle_no, dbo.Driver_Allocation.DRIVER_CONTACT_NO, dbo.Vehicle_Trip_Details.ESTIMATE_PACKAGING_UNIT, 
             dbo.Vehicle_Trip_Details.LOCATION_FROM, dbo.Vehicle_Trip_Details.LOCATION_TO, dbo.Vehicle_Trip_Details.BOARDING_OFFICER_NAME, dbo.Vehicle_Trip_Details.TRANSPORT_COMPANY, dbo.Vehicle_Trip_Details.CTM, dbo.Vehicle_Trip_Details.ACTUAL_DELIVERY_START, 
             dbo.Vehicle_Trip_Details.ACTUAL_DELIVERY_END, dbo.Driver_Allocation.PLANNED_FROM, dbo.Driver_Allocation.PLANNED_TO, dbo.Driver_Allocation.OUTSOURCED_VEHICLE_NO, dbo.Driver_Allocation.OUTSOURCED_CONTACT_PERSON, 
             dbo.Driver_Allocation.OUTSOURCED_CONTACT_NO, dbo.Driver_Allocation.DRIVER_CODE
FROM   dbo.Mast_STATUSES RIGHT OUTER JOIN
             dbo.Driver_Allocation INNER JOIN
             dbo.SHIPMENT ON dbo.Driver_Allocation.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID ON dbo.Mast_STATUSES.STATUSID = dbo.SHIPMENT.SHIPMENT_STATUSID LEFT OUTER JOIN
             dbo.MAST_TRANSPORT_TYPE RIGHT OUTER JOIN
             dbo.Vehicle_Trip_Details INNER JOIN
             dbo.Vehicle_Trip_Planning ON dbo.Vehicle_Trip_Details.TRIPID = dbo.Vehicle_Trip_Planning.TRIPID ON dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID = dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID ON 
             dbo.SHIPMENT.SHIPMENTID = dbo.Vehicle_Trip_Planning.SHIPMENTID
GO


CREATE TABLE [dbo].[Driver_Allocation](
	[DriverAllocationId] [int] IDENTITY(1,1) NOT NULL,
	[ContractId] [int] NULL,
	[Driver_ID] [int] NULL,
	[Driver_Name] [varchar](255) NULL,
	[Trip_plan_no] [int] NULL,
	[Vehicle_no] [varchar](255) NULL,
	[A_Role] [varchar](255) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[SHIPMENTID] [int] NULL,
	[PLANNED_FROM] [datetime] NULL,
	[PLANNED_TO] [datetime] NULL,
	[CHASSIS_NO] [nvarchar](50) NULL,
	[TRIPDETAILID] [int] NULL,
	[TRIPID] [int] NULL,
	[Is_Present] [int] NULL,
	[Is_Main] [int] NULL,
	[EPOD_Driver_Remarks] [nvarchar](4000) NULL,
	[DRIVER_CONTACT_NO] [nvarchar](50) NULL,
	[OUTSOURCED_VEHICLE_NO] [nvarchar](50) NULL,
	[OUTSOURCED_CONTACT_PERSON] [nvarchar](100) NULL,
	[OUTSOURCED_CONTACT_NO] [nvarchar](50) NULL,
	[DRIVER_CODE] [nvarchar](50) NULL,
 CONSTRAINT [PK_Driver_Allocation] PRIMARY KEY CLUSTERED 
(
	[DriverAllocationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO



CREATE VIEW [dbo].[V_SHIPMENT_TRIP_PLAN]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.Mast_STATUSES.STATUS_DESC, dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.Driver_Allocation.Driver_Name, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, 
             dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Vehicle_no, dbo.Driver_Allocation.DRIVER_CONTACT_NO, dbo.Vehicle_Trip_Details.ESTIMATE_PACKAGING_UNIT, 
             dbo.Vehicle_Trip_Details.LOCATION_FROM, dbo.Vehicle_Trip_Details.LOCATION_TO, dbo.Vehicle_Trip_Details.BOARDING_OFFICER_NAME, dbo.Vehicle_Trip_Details.TRANSPORT_COMPANY, dbo.Vehicle_Trip_Details.CTM, dbo.Vehicle_Trip_Details.ACTUAL_DELIVERY_START, 
             dbo.Vehicle_Trip_Details.ACTUAL_DELIVERY_END, dbo.Driver_Allocation.PLANNED_FROM, dbo.Driver_Allocation.PLANNED_TO, dbo.Driver_Allocation.OUTSOURCED_VEHICLE_NO, dbo.Driver_Allocation.OUTSOURCED_CONTACT_PERSON, 
             dbo.Driver_Allocation.OUTSOURCED_CONTACT_NO, dbo.Driver_Allocation.DRIVER_CODE
FROM   dbo.Mast_STATUSES RIGHT OUTER JOIN
             dbo.Driver_Allocation INNER JOIN
             dbo.SHIPMENT ON dbo.Driver_Allocation.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID ON dbo.Mast_STATUSES.STATUSID = dbo.SHIPMENT.SHIPMENT_STATUSID LEFT OUTER JOIN
             dbo.MAST_TRANSPORT_TYPE RIGHT OUTER JOIN
             dbo.Vehicle_Trip_Details INNER JOIN
             dbo.Vehicle_Trip_Planning ON dbo.Vehicle_Trip_Details.TRIPID = dbo.Vehicle_Trip_Planning.TRIPID ON dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID = dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID ON 
             dbo.SHIPMENT.SHIPMENTID = dbo.Vehicle_Trip_Planning.SHIPMENTID
GO


CREATE VIEW [dbo].[V_SHIPMENT_INFO]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.RECEIVERID, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.SHIPMENT.PLANNED_DELIVERY_DATE, dbo.SHIPMENT.SHIPMENT_NOTES, 
                  dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.SHIPMENT.COMPANYID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ETA, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ATA, 
                  dbo.SHIPMENT_VESSEL_INFO.DELIVERY_DATE, dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID, dbo.SHIPMENT_VESSEL_INFO.AGENT, dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_PERSON, 
                  dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_NO, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_PERSON, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_NO, 
                  dbo.SHIPMENT_VESSEL_INFO.LOADING_POINT, dbo.SHIPMENT_VESSEL_INFO.LOADING_TIME, dbo.SHIPMENT_VESSEL_INFO.CO_PARTY, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, 
                  dbo.MAST_VESSEL.IMO_NO, dbo.MAST_ANCHORAGE.ANCHORAGE_CODE, dbo.MAST_ANCHORAGE.ANCHORAGE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, 
                  dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Driver_Name
FROM     dbo.MAST_TRANSPORT_TYPE RIGHT OUTER JOIN
                  dbo.Vehicle_Trip_Planning LEFT OUTER JOIN
                  dbo.Driver_Allocation ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Driver_Allocation.TRIPID LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Details ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Vehicle_Trip_Details.TRIPID RIGHT OUTER JOIN
                  dbo.SHIPMENT ON dbo.Vehicle_Trip_Planning.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID ON dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID = dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID LEFT OUTER JOIN
                  dbo.MAST_ANCHORAGE RIGHT OUTER JOIN
                  dbo.SHIPMENT_VESSEL_INFO ON dbo.MAST_ANCHORAGE.ANCHORAGE_ID = dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID ON dbo.SHIPMENT.SHIPMENTID = dbo.SHIPMENT_VESSEL_INFO.SHIPMENTID
GO

CREATE VIEW [dbo].[V_MODULE_STATUSES]
AS
SELECT dbo.Mast_STATUSES.STATUSID, dbo.Mast_STATUSES.STATUS_DESC, dbo.Module_Status.MODULEID, dbo.Module_Status.STATUS_LEVEL
FROM     dbo.Mast_STATUSES LEFT OUTER JOIN
                  dbo.Module_Status ON dbo.Mast_STATUSES.STATUSID = dbo.Module_Status.STATUSID
GO

ALTER VIEW [dbo].[V_DELIVERY_ORDERS_INFO]
AS
SELECT dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.SHIPMENTID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDERS.TRIPID, 
                  dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, dbo.DELIVERY_ORDER_INFO.CONTACT, dbo.DELIVERY_ORDER_INFO.VESSEL_ID, dbo.DELIVERY_ORDER_INFO.VESSEL_ETA, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.POSTING_DATE, dbo.DELIVERY_ORDER_INFO.REQUESTED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.MARK_REFERENCE_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.CUSTOMER_NO, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMER_NAME, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.MAST_VESSEL.IMO_NO, dbo.SHIPMENT.JOBNO, 
                  dbo.Mast_STATUSES.STATUS_DESC, dbo.DELIVERY_ORDERS.STATUSID, dbo.SHIPMENT.ORDER_NO, dbo.DELIVERY_ORDER_INFO.PARENT_CUSTOMER, dbo.DELIVERY_ORDER_INFO.PROMISED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDERS.COMPANYID, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMERID
FROM     dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO


ALTER VIEW [dbo].[V_DELIVERY_ORDER_LINES]
AS
SELECT dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_LINES_ID, dbo.DELIVERY_ORDER_LINES.ITEM_NO, dbo.DELIVERY_ORDER_LINES.ITEM_REF_NO, dbo.DELIVERY_ORDER_LINES.ITEM_DESCRIPTION, 
                  dbo.DELIVERY_ORDER_LINES.QUANTITY, dbo.DELIVERY_ORDER_LINES.UOM, dbo.DELIVERY_ORDER_LINES.AWB_BL, dbo.DELIVERY_ORDER_LINES.QUANTITY_INVOICED, dbo.DELIVERY_ORDER_LINES.STATUSID, 
                  dbo.DELIVERY_ORDER_LINES.CREATED_DATE, dbo.DELIVERY_ORDER_LINES.UPDATED_DATE, dbo.DELIVERY_ORDER_LINES.GRN_REASON_ID, dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID, 
                  dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.SHIPMENT.JOBNO, dbo.MAST_VESSEL.VESSEL_CODE, 
                  dbo.MAST_VESSEL.VESSEL_NAME, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_LINES.BROKER_CODE, dbo.DELIVERY_ORDER_INFO.DEPT_CODE, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_LINES.EPOD_LINE_REMARKS
FROM     dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_LINES ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO


ALTER VIEW [dbo].[V_SHIPMENT_INFO]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.RECEIVERID, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.SHIPMENT.PLANNED_DELIVERY_DATE, dbo.SHIPMENT.SHIPMENT_NOTES, 
                  dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.SHIPMENT.COMPANYID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ETA, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ATA, 
                  dbo.SHIPMENT_VESSEL_INFO.DELIVERY_DATE, dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID, dbo.SHIPMENT_VESSEL_INFO.AGENT, dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_PERSON, 
                  dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_NO, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_PERSON, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_NO, 
                  dbo.SHIPMENT_VESSEL_INFO.LOADING_POINT, dbo.SHIPMENT_VESSEL_INFO.LOADING_TIME, dbo.SHIPMENT_VESSEL_INFO.CO_PARTY, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, 
                  dbo.MAST_VESSEL.IMO_NO, dbo.MAST_ANCHORAGE.ANCHORAGE_CODE, dbo.MAST_ANCHORAGE.ANCHORAGE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, 
                  dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Driver_Name, dbo.LES_CUSTOMERS.CUST_CODE, dbo.LES_CUSTOMERS.CUST_NAME, 
                  dbo.Mast_STATUSES.STATUS_DESC AS SHIPMENT_STATUSDESC
FROM     dbo.LES_CUSTOMERS RIGHT OUTER JOIN
                  dbo.Mast_STATUSES RIGHT OUTER JOIN
                  dbo.SHIPMENT ON dbo.Mast_STATUSES.STATUSID = dbo.SHIPMENT.SHIPMENT_STATUSID ON dbo.LES_CUSTOMERS.CUSTOMERID = dbo.SHIPMENT.RECEIVERID LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Planning LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Details ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Vehicle_Trip_Details.TRIPID LEFT OUTER JOIN
                  dbo.Driver_Allocation ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Driver_Allocation.TRIPID ON dbo.SHIPMENT.SHIPMENTID = dbo.Vehicle_Trip_Planning.SHIPMENTID LEFT OUTER JOIN
                  dbo.MAST_TRANSPORT_TYPE ON dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID = dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID LEFT OUTER JOIN
                  dbo.MAST_ANCHORAGE RIGHT OUTER JOIN
                  dbo.SHIPMENT_VESSEL_INFO ON dbo.MAST_ANCHORAGE.ANCHORAGE_ID = dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID ON dbo.SHIPMENT.SHIPMENTID = dbo.SHIPMENT_VESSEL_INFO.SHIPMENTID
GO


drop table MAST_ANCHORAGE

CREATE TABLE [dbo].[MAST_ANCHORAGE](
	[ANCHORAGE_ID] [int] IDENTITY(1,1) NOT NULL,
	[ANCHORAGE_CODE] [nvarchar](50) NULL,
	[ANCHORAGE_DESCRIPTION] [nvarchar](250) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_DATE] [datetime] NULL,
	[CREATED_BY] [int] NULL,
	[UPDATED_BY] [int] NULL,
 CONSTRAINT [PK_MAST_ANCHORAGE] PRIMARY KEY CLUSTERED 
(
	[ANCHORAGE_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

Alter table DELIVERY_ORDER_INFO
add CURRENCY_CODE nvarchar(10)

ALTER VIEW [dbo].[V_DELIVERY_ORDERS_INFO]
AS
SELECT dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.SHIPMENTID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDERS.TRIPID, 
                  dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, dbo.DELIVERY_ORDER_INFO.CONTACT, dbo.DELIVERY_ORDER_INFO.VESSEL_ID, dbo.DELIVERY_ORDER_INFO.VESSEL_ETA, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.POSTING_DATE, dbo.DELIVERY_ORDER_INFO.REQUESTED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.MARK_REFERENCE_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.CUSTOMER_NO, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMER_NAME, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.MAST_VESSEL.IMO_NO, dbo.SHIPMENT.JOBNO, 
                  dbo.Mast_STATUSES.STATUS_DESC, dbo.DELIVERY_ORDERS.STATUSID, dbo.SHIPMENT.ORDER_NO, dbo.DELIVERY_ORDER_INFO.PARENT_CUSTOMER, dbo.DELIVERY_ORDER_INFO.PROMISED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDERS.COMPANYID, dbo.DELIVERY_ORDER_INFO.CUSTOMERID, 
                  dbo.DELIVERY_ORDER_INFO.CURRENCY_CODE
FROM     dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO

alter table Driver_Allocation
add ALLOWANCE_AMT float

alter table DELIVERY_ORDER_INFO
add DO_JOB_NO nvarchar(20)

ALTER VIEW [dbo].[V_DELIVERY_ORDERS_INFO]
AS
SELECT dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.SHIPMENTID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDERS.TRIPID, 
                  dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, dbo.DELIVERY_ORDER_INFO.CONTACT, dbo.DELIVERY_ORDER_INFO.VESSEL_ID, dbo.DELIVERY_ORDER_INFO.VESSEL_ETA, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.POSTING_DATE, dbo.DELIVERY_ORDER_INFO.REQUESTED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.MARK_REFERENCE_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.CUSTOMER_NO, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMER_NAME, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.MAST_VESSEL.IMO_NO, dbo.SHIPMENT.JOBNO, 
                  dbo.Mast_STATUSES.STATUS_DESC, dbo.DELIVERY_ORDERS.STATUSID, dbo.SHIPMENT.ORDER_NO, dbo.DELIVERY_ORDER_INFO.PARENT_CUSTOMER, dbo.DELIVERY_ORDER_INFO.PROMISED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDERS.COMPANYID, dbo.DELIVERY_ORDER_INFO.CUSTOMERID, 
                  dbo.DELIVERY_ORDER_INFO.CURRENCY_CODE, dbo.DELIVERY_ORDER_INFO.DO_JOB_NO
FROM     dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO



CREATE TABLE [dbo].[Mast_SITE_CONFIG](
	[SITECONFIGID] [int] IDENTITY(1,1) NOT NULL,
	[MODULEID] [int] NULL,
	[SITEID] [int] NULL,
	[COMPANYID][int] NULL,
	[SITECONFIG_PARAMID] [int] NULL,
	[SITECONFIG_PARAM_CODE] [nvarchar](50) NULL,
	[PARAM_VALUE] [nvarchar](75) NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATE_DATE] [datetime] NULL
) ON [PRIMARY]
GO


alter table LES_USER_COMPANY_LINK
drop CONSTRAINT FK_LES_USER_COMPANY_LINK_LES_COMPANY

alter table LES_COMPANY
drop CONSTRAINT PK_MAST_COMPANY



ALTER VIEW [dbo].[V_SHIPMENT_TRIP_PLAN]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.Mast_STATUSES.STATUS_DESC, dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.Driver_Allocation.Driver_Name, 
                  dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Vehicle_no, 
                  dbo.Driver_Allocation.DRIVER_CONTACT_NO, dbo.Vehicle_Trip_Details.ESTIMATE_PACKAGING_UNIT, dbo.Vehicle_Trip_Details.LOCATION_FROM, dbo.Vehicle_Trip_Details.LOCATION_TO, 
                  dbo.Vehicle_Trip_Details.BOARDING_OFFICER_NAME, dbo.Vehicle_Trip_Details.TRANSPORT_COMPANY, dbo.Vehicle_Trip_Details.CTM, dbo.Vehicle_Trip_Details.ACTUAL_DELIVERY_START, 
                  dbo.Vehicle_Trip_Details.ACTUAL_DELIVERY_END, dbo.Driver_Allocation.PLANNED_FROM, dbo.Driver_Allocation.PLANNED_TO, dbo.Driver_Allocation.OUTSOURCED_VEHICLE_NO, 
                  dbo.Driver_Allocation.OUTSOURCED_CONTACT_PERSON, dbo.Driver_Allocation.OUTSOURCED_CONTACT_NO, dbo.Driver_Allocation.DRIVER_CODE, dbo.Driver_Allocation.ALLOWANCE_AMT
FROM     dbo.Mast_STATUSES RIGHT OUTER JOIN
                  dbo.Driver_Allocation RIGHT OUTER JOIN
                  dbo.SHIPMENT ON dbo.Driver_Allocation.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID ON dbo.Mast_STATUSES.STATUSID = dbo.SHIPMENT.SHIPMENT_STATUSID LEFT OUTER JOIN
                  dbo.MAST_TRANSPORT_TYPE RIGHT OUTER JOIN
                  dbo.Vehicle_Trip_Details INNER JOIN
                  dbo.Vehicle_Trip_Planning ON dbo.Vehicle_Trip_Details.TRIPID = dbo.Vehicle_Trip_Planning.TRIPID ON dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID = dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID ON 
                  dbo.SHIPMENT.SHIPMENTID = dbo.Vehicle_Trip_Planning.SHIPMENTID
GO


ALTER VIEW [dbo].[V_SHIPMENT_INFO]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.RECEIVERID, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.SHIPMENT.PLANNED_DELIVERY_DATE, dbo.SHIPMENT.SHIPMENT_NOTES, 
                  dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.SHIPMENT.COMPANYID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ETA, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ATA, 
                  dbo.SHIPMENT_VESSEL_INFO.DELIVERY_DATE, dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID, dbo.SHIPMENT_VESSEL_INFO.AGENT, dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_PERSON, 
                  dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_NO, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_PERSON, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_NO, 
                  dbo.SHIPMENT_VESSEL_INFO.LOADING_POINT, dbo.SHIPMENT_VESSEL_INFO.LOADING_TIME, dbo.SHIPMENT_VESSEL_INFO.CO_PARTY, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, 
                  dbo.MAST_VESSEL.IMO_NO, dbo.MAST_ANCHORAGE.ANCHORAGE_CODE, dbo.MAST_ANCHORAGE.ANCHORAGE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, 
                  dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Driver_Name, dbo.LES_CUSTOMERS.CUST_CODE, dbo.LES_CUSTOMERS.CUST_NAME, 
                  dbo.Mast_STATUSES.STATUS_DESC AS SHIPMENT_STATUSDESC, dbo.SHIPMENT_VESSEL_INFO.EPOD_SHIPMENT_NOTES
FROM     dbo.LES_CUSTOMERS RIGHT OUTER JOIN
                  dbo.Mast_STATUSES RIGHT OUTER JOIN
                  dbo.SHIPMENT ON dbo.Mast_STATUSES.STATUSID = dbo.SHIPMENT.SHIPMENT_STATUSID ON dbo.LES_CUSTOMERS.CUSTOMERID = dbo.SHIPMENT.RECEIVERID LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Planning LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Details ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Vehicle_Trip_Details.TRIPID LEFT OUTER JOIN
                  dbo.Driver_Allocation ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Driver_Allocation.TRIPID ON dbo.SHIPMENT.SHIPMENTID = dbo.Vehicle_Trip_Planning.SHIPMENTID LEFT OUTER JOIN
                  dbo.MAST_TRANSPORT_TYPE ON dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID = dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID LEFT OUTER JOIN
                  dbo.MAST_ANCHORAGE RIGHT OUTER JOIN
                  dbo.SHIPMENT_VESSEL_INFO ON dbo.MAST_ANCHORAGE.ANCHORAGE_ID = dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID ON dbo.SHIPMENT.SHIPMENTID = dbo.SHIPMENT_VESSEL_INFO.SHIPMENTID
GO


ALTER VIEW [dbo].[V_DELIVERY_ORDERS_INFO]
AS
SELECT dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.SHIPMENTID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDERS.TRIPID, 
                  dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, dbo.DELIVERY_ORDER_INFO.CONTACT, dbo.DELIVERY_ORDER_INFO.VESSEL_ID, dbo.DELIVERY_ORDER_INFO.VESSEL_ETA, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.POSTING_DATE, dbo.DELIVERY_ORDER_INFO.REQUESTED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.MARK_REFERENCE_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.CUSTOMER_NO, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMER_NAME, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.MAST_VESSEL.IMO_NO, dbo.SHIPMENT.JOBNO, 
                  dbo.Mast_STATUSES.STATUS_DESC, dbo.DELIVERY_ORDERS.STATUSID, dbo.SHIPMENT.ORDER_NO, dbo.DELIVERY_ORDER_INFO.PARENT_CUSTOMER, dbo.DELIVERY_ORDER_INFO.PROMISED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDERS.COMPANYID, dbo.DELIVERY_ORDER_INFO.CUSTOMERID, 
                  dbo.DELIVERY_ORDER_INFO.CURRENCY_CODE, dbo.DELIVERY_ORDER_INFO.DO_JOB_NO, dbo.DELIVERY_ORDER_INFO.GOOD_RETURN_REMARKS
FROM     dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO


ALTER VIEW [dbo].[V_DELIVERY_ORDER_LINES]
AS
SELECT dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_LINES_ID, dbo.DELIVERY_ORDER_LINES.ITEM_NO, dbo.DELIVERY_ORDER_LINES.ITEM_REF_NO, dbo.DELIVERY_ORDER_LINES.ITEM_DESCRIPTION, 
                  dbo.DELIVERY_ORDER_LINES.QUANTITY, dbo.DELIVERY_ORDER_LINES.UOM, dbo.DELIVERY_ORDER_LINES.AWB_BL, dbo.DELIVERY_ORDER_LINES.QUANTITY_INVOICED, dbo.DELIVERY_ORDER_LINES.STATUSID, 
                  dbo.DELIVERY_ORDER_LINES.CREATED_DATE, dbo.DELIVERY_ORDER_LINES.UPDATED_DATE, dbo.DELIVERY_ORDER_LINES.GRN_REASON_ID, dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID, 
                  dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.SHIPMENT.JOBNO, dbo.MAST_VESSEL.VESSEL_CODE, 
                  dbo.MAST_VESSEL.VESSEL_NAME, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_LINES.BROKER_CODE, dbo.DELIVERY_ORDER_INFO.DEPT_CODE, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_LINES.EPOD_LINE_REMARKS, dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_CODE, 
                  dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_DESCRIPTION
FROM     dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_LINES ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.MAST_GOODS_RETURN_REASONS ON dbo.DELIVERY_ORDER_LINES.GRN_REASON_ID = dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_ID LEFT OUTER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO

ALTER VIEW [dbo].[V_SHIPMENT_INFO]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.RECEIVERID, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.SHIPMENT.PLANNED_DELIVERY_DATE, dbo.SHIPMENT.SHIPMENT_NOTES, 
                  dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.SHIPMENT.COMPANYID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ETA, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ATA, 
                  dbo.SHIPMENT_VESSEL_INFO.DELIVERY_DATE, dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID, dbo.SHIPMENT_VESSEL_INFO.AGENT, dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_PERSON, 
                  dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_NO, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_PERSON, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_NO, 
                  dbo.SHIPMENT_VESSEL_INFO.LOADING_POINT, dbo.SHIPMENT_VESSEL_INFO.LOADING_TIME, dbo.SHIPMENT_VESSEL_INFO.CO_PARTY, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, 
                  dbo.MAST_VESSEL.IMO_NO, dbo.MAST_ANCHORAGE.ANCHORAGE_CODE, dbo.MAST_ANCHORAGE.ANCHORAGE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, 
                  dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Driver_Name, dbo.LES_CUSTOMERS.CUST_CODE, dbo.LES_CUSTOMERS.CUST_NAME, 
                  dbo.Mast_STATUSES.STATUS_DESC AS SHIPMENT_STATUSDESC, dbo.SHIPMENT_VESSEL_INFO.EPOD_SHIPMENT_NOTES, dbo.SHIPMENT.Is_Delete
FROM     dbo.LES_CUSTOMERS RIGHT OUTER JOIN
                  dbo.Mast_STATUSES RIGHT OUTER JOIN
                  dbo.SHIPMENT ON dbo.Mast_STATUSES.STATUSID = dbo.SHIPMENT.SHIPMENT_STATUSID ON dbo.LES_CUSTOMERS.CUSTOMERID = dbo.SHIPMENT.RECEIVERID LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Planning LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Details ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Vehicle_Trip_Details.TRIPID LEFT OUTER JOIN
                  dbo.Driver_Allocation ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Driver_Allocation.TRIPID ON dbo.SHIPMENT.SHIPMENTID = dbo.Vehicle_Trip_Planning.SHIPMENTID LEFT OUTER JOIN
                  dbo.MAST_TRANSPORT_TYPE ON dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID = dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID LEFT OUTER JOIN
                  dbo.MAST_ANCHORAGE RIGHT OUTER JOIN
                  dbo.SHIPMENT_VESSEL_INFO ON dbo.MAST_ANCHORAGE.ANCHORAGE_ID = dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID ON dbo.SHIPMENT.SHIPMENTID = dbo.SHIPMENT_VESSEL_INFO.SHIPMENTID
GO

ALTER VIEW [dbo].[V_SHIPMENT_DELIVERY_ORDERS]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.JOBNO, Mast_STATUSES_1.STATUS_DESC AS SHIPMENT_STATUS_DESC, dbo.Mast_STATUSES.STATUS_DESC AS DO_STATUS_DESC, 
                  dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.TRIPID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_INFO.PONO
FROM     dbo.SHIPMENT INNER JOIN
                  dbo.DELIVERY_ORDERS ON dbo.SHIPMENT.SHIPMENTID = dbo.DELIVERY_ORDERS.SHIPMENTID INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.Mast_STATUSES AS Mast_STATUSES_1 ON dbo.SHIPMENT.SHIPMENT_STATUSID = Mast_STATUSES_1.STATUSID
GO

ALTER VIEW [dbo].[V_DELIVERY_ORDERS_INFO]
AS
SELECT dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.SHIPMENTID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDERS.TRIPID, 
                  dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, dbo.DELIVERY_ORDER_INFO.CONTACT, dbo.DELIVERY_ORDER_INFO.VESSEL_ID, dbo.DELIVERY_ORDER_INFO.VESSEL_ETA, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.POSTING_DATE, dbo.DELIVERY_ORDER_INFO.REQUESTED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.MARK_REFERENCE_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.CUSTOMER_NO, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMER_NAME, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.MAST_VESSEL.IMO_NO, dbo.SHIPMENT.JOBNO, 
                  dbo.Mast_STATUSES.STATUS_DESC, dbo.DELIVERY_ORDERS.STATUSID, dbo.SHIPMENT.ORDER_NO, dbo.DELIVERY_ORDER_INFO.PARENT_CUSTOMER, dbo.DELIVERY_ORDER_INFO.PROMISED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDERS.COMPANYID, dbo.DELIVERY_ORDER_INFO.CUSTOMERID, 
                  dbo.DELIVERY_ORDER_INFO.CURRENCY_CODE, dbo.DELIVERY_ORDER_INFO.DO_JOB_NO, dbo.DELIVERY_ORDER_INFO.GOOD_RETURN_REMARKS, dbo.DELIVERY_ORDERS.END_CUSTOMERID
FROM     dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO

ALTER TABLE EPOD_ACCESS_LOG
add SHIPPED_DATE datetime

ALTER TABLE EPOD_ACCESS_LOG
add CONFIRM_DATE datetime

ALTER TABLE EPOD_ACCESS_LOG
alter column LOCATION_LAT nvarchar(20)

ALTER TABLE EPOD_ACCESS_LOG
alter column LOCATION_LONG nvarchar(20)

alter table SHIPMENT_VESSEL_INFO
alter column CO_PARTY nvarchar(300)



ALTER VIEW [dbo].[V_SHIPMENT_INFO]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.RECEIVERID, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.SHIPMENT.PLANNED_DELIVERY_DATE, dbo.SHIPMENT.SHIPMENT_NOTES, 
                  dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.SHIPMENT.COMPANYID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ETA, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ATA, 
                  dbo.SHIPMENT_VESSEL_INFO.DELIVERY_DATE, dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID, dbo.SHIPMENT_VESSEL_INFO.AGENT, dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_PERSON, 
                  dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_NO, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_PERSON, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_NO, 
                  dbo.SHIPMENT_VESSEL_INFO.LOADING_POINT, dbo.SHIPMENT_VESSEL_INFO.LOADING_TIME, dbo.SHIPMENT_VESSEL_INFO.CO_PARTY, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, 
                  dbo.MAST_VESSEL.IMO_NO, dbo.MAST_ANCHORAGE.ANCHORAGE_CODE, dbo.MAST_ANCHORAGE.ANCHORAGE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, 
                  dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Driver_Name, dbo.LES_CUSTOMERS.CUST_CODE, dbo.LES_CUSTOMERS.CUST_NAME, 
                  dbo.Mast_STATUSES.STATUS_DESC AS SHIPMENT_STATUSDESC, dbo.SHIPMENT_VESSEL_INFO.EPOD_SHIPMENT_NOTES, dbo.SHIPMENT.Is_Delete, dbo.Driver_Allocation.Vehicle_no, 
                  dbo.Vehicle_Trip_Details.BOARDING_OFFICER_NAME
FROM     dbo.MAST_ANCHORAGE RIGHT OUTER JOIN
                  dbo.SHIPMENT_VESSEL_INFO ON dbo.MAST_ANCHORAGE.ANCHORAGE_ID = dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID RIGHT OUTER JOIN
                  dbo.Mast_STATUSES RIGHT OUTER JOIN
                  dbo.Driver_Allocation RIGHT OUTER JOIN
                  dbo.SHIPMENT ON dbo.Driver_Allocation.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID ON dbo.Mast_STATUSES.STATUSID = dbo.SHIPMENT.SHIPMENT_STATUSID LEFT OUTER JOIN
                  dbo.LES_CUSTOMERS ON dbo.SHIPMENT.RECEIVERID = dbo.LES_CUSTOMERS.CUSTOMERID ON dbo.SHIPMENT_VESSEL_INFO.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID FULL OUTER JOIN
                  dbo.Vehicle_Trip_Planning LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Details ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Vehicle_Trip_Details.TRIPID LEFT OUTER JOIN
                  dbo.MAST_TRANSPORT_TYPE ON dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID = dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID ON dbo.SHIPMENT.SHIPMENTID = dbo.Vehicle_Trip_Planning.SHIPMENTID
GO

alter table EPOD_ACCESS_LOG
add VESSELIMO nvarchar(50),
ROLE nvarchar(50),
USER_NAME nvarchar(150)


-------------------------------------------- USER ADMINISTRATOR
ALTER TABLE LES_COMPANY
ALTER COLUMN LOGOPATH nvarchar(150);

ALTER TABLE LES_COMPANY
add  MIN_LOGOPATH nvarchar(150);


ALTER VIEW [dbo].[V_COMPANY_DETAILS]
AS
SELECT dbo.LES_COMPANY.COMPANY_CODE, dbo.LES_COMPANY.COMPANYID, dbo.LES_COMPANY.COMPANY_DESCRIPTION, dbo.LES_COMPANY.LOGOPATH, dbo.LES_COMPANY.ADDRESSID, dbo.LES_USER_COMPANY_LINK.EX_USERID, 
                  dbo.LES_USER_COMPANY_LINK.USERTYPEID, dbo.LES_USERTYPE.USERTYPEDESCR, dbo.LES_USER_COMPANY_LINK.USER_COMPANY_LINK_ID, dbo.LES_COMPANY.MIN_LOGOPATH
FROM     dbo.LES_USERTYPE INNER JOIN
                  dbo.LES_USER_COMPANY_LINK ON dbo.LES_USERTYPE.USERTYPEID = dbo.LES_USER_COMPANY_LINK.USERTYPEID INNER JOIN
                  dbo.LES_COMPANY ON dbo.LES_USER_COMPANY_LINK.COMPANYID = dbo.LES_COMPANY.COMPANYID
GO

ALTER TABLE LES_COMPANY
ALTER COLUMN LOGOPATH nvarchar(150);

alter table LES_COMPANY
add PRINT_LOGO_PATH nvarchar(150)

ALTER VIEW [dbo].[V_COMPANY_DETAILS]
AS
SELECT dbo.LES_COMPANY.COMPANY_CODE, dbo.LES_COMPANY.COMPANYID, dbo.LES_COMPANY.COMPANY_DESCRIPTION, dbo.LES_COMPANY.LOGOPATH, dbo.LES_COMPANY.ADDRESSID, dbo.LES_USER_COMPANY_LINK.EX_USERID, 
                  dbo.LES_USER_COMPANY_LINK.USERTYPEID, dbo.LES_USERTYPE.USERTYPEDESCR, dbo.LES_USER_COMPANY_LINK.USER_COMPANY_LINK_ID, dbo.LES_COMPANY.MIN_LOGOPATH, dbo.LES_COMPANY.PRINT_LOGO_PATH
FROM     dbo.LES_USERTYPE INNER JOIN
                  dbo.LES_USER_COMPANY_LINK ON dbo.LES_USERTYPE.USERTYPEID = dbo.LES_USER_COMPANY_LINK.USERTYPEID INNER JOIN
                  dbo.LES_COMPANY ON dbo.LES_USER_COMPANY_LINK.COMPANYID = dbo.LES_COMPANY.COMPANYID
GO

----------------------------------------------CONLASH DB ------------25-06-2024

alter table SHIPMENT_VESSEL_INFO
add InitialReceiptExported int,
FinalReceiptExported int


ALTER VIEW [dbo].[V_SHIPMENT_INFO]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.RECEIVERID, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.SHIPMENT.PLANNED_DELIVERY_DATE, dbo.SHIPMENT.SHIPMENT_NOTES, 
                  dbo.SHIPMENT.SHIPMENT_STATUSID, dbo.SHIPMENT.JOBNO, dbo.SHIPMENT.COMPANYID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ETA, dbo.SHIPMENT_VESSEL_INFO.VESSEL_ATA, 
                  dbo.SHIPMENT_VESSEL_INFO.DELIVERY_DATE, dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID, dbo.SHIPMENT_VESSEL_INFO.AGENT, dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_PERSON, 
                  dbo.SHIPMENT_VESSEL_INFO.AGENT_CONTACT_NO, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_PERSON, dbo.SHIPMENT_VESSEL_INFO.SUPPLY_BOAT_CONTACT_NO, 
                  dbo.SHIPMENT_VESSEL_INFO.LOADING_POINT, dbo.SHIPMENT_VESSEL_INFO.LOADING_TIME, dbo.SHIPMENT_VESSEL_INFO.CO_PARTY, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, 
                  dbo.MAST_VESSEL.IMO_NO, dbo.MAST_ANCHORAGE.ANCHORAGE_CODE, dbo.MAST_ANCHORAGE.ANCHORAGE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_CODE, 
                  dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_DESCRIPTION, dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID, dbo.Driver_Allocation.Driver_Name, dbo.LES_CUSTOMERS.CUST_CODE, dbo.LES_CUSTOMERS.CUST_NAME, 
                  dbo.Mast_STATUSES.STATUS_DESC AS SHIPMENT_STATUSDESC, dbo.SHIPMENT_VESSEL_INFO.EPOD_SHIPMENT_NOTES, dbo.SHIPMENT.Is_Delete, dbo.Driver_Allocation.Vehicle_no, 
                  dbo.Vehicle_Trip_Details.BOARDING_OFFICER_NAME, dbo.SHIPMENT_VESSEL_INFO.InitialReceiptExported, dbo.SHIPMENT_VESSEL_INFO.FinalReceiptExported
FROM     dbo.MAST_ANCHORAGE RIGHT OUTER JOIN
                  dbo.SHIPMENT_VESSEL_INFO ON dbo.MAST_ANCHORAGE.ANCHORAGE_ID = dbo.SHIPMENT_VESSEL_INFO.ANCHORAGE_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.SHIPMENT_VESSEL_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID RIGHT OUTER JOIN
                  dbo.Mast_STATUSES RIGHT OUTER JOIN
                  dbo.Driver_Allocation RIGHT OUTER JOIN
                  dbo.SHIPMENT ON dbo.Driver_Allocation.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID ON dbo.Mast_STATUSES.STATUSID = dbo.SHIPMENT.SHIPMENT_STATUSID LEFT OUTER JOIN
                  dbo.LES_CUSTOMERS ON dbo.SHIPMENT.RECEIVERID = dbo.LES_CUSTOMERS.CUSTOMERID ON dbo.SHIPMENT_VESSEL_INFO.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID FULL OUTER JOIN
                  dbo.Vehicle_Trip_Planning LEFT OUTER JOIN
                  dbo.Vehicle_Trip_Details ON dbo.Vehicle_Trip_Planning.TRIPID = dbo.Vehicle_Trip_Details.TRIPID LEFT OUTER JOIN
                  dbo.MAST_TRANSPORT_TYPE ON dbo.Vehicle_Trip_Details.TRANSPORT_TYPE_ID = dbo.MAST_TRANSPORT_TYPE.TRANSPORT_TYPE_ID ON dbo.SHIPMENT.SHIPMENTID = dbo.Vehicle_Trip_Planning.SHIPMENTID
GO


------------26-06-2024

ALTER VIEW [dbo].[V_APPLICATION_MODULE_ACCESS]
AS
SELECT row_number() OVER (ORDER BY ([MODULEACCESSID])) rownum, dbo.LES_MODULE.MODULEID, dbo.LES_MODULE.APPLICATIONID, dbo.LES_MODULE.MODULE_CODE, dbo.LES_MODULE.MODULE_DESC, dbo.LES_USERTYPE_MODULE_ACCESS.MODULEACCESSID, 
                  dbo.LES_USERTYPE_MODULE_ACCESS.USERTYPEID, dbo.LES_USERTYPE_MODULE_ACCESS.ACCESS_LEVEL, dbo.LES_USERTYPE.USERTYPEDESCR, dbo.LES_USER_COMPANY_LINK.EX_USERID, 
                  dbo.LES_USER_COMPANY_LINK.COMPANYID, dbo.LES_USER_COMPANY_LINK.USER_COMPANY_LINK_ID, dbo.LES_APPLICATIONS.APPLICATION_NAME
FROM     dbo.LES_MODULE INNER JOIN
                  dbo.LES_USERTYPE_MODULE_ACCESS ON dbo.LES_MODULE.MODULEID = dbo.LES_USERTYPE_MODULE_ACCESS.MODULEID INNER JOIN
                  dbo.LES_USERTYPE ON dbo.LES_USERTYPE_MODULE_ACCESS.USERTYPEID = dbo.LES_USERTYPE.USERTYPEID INNER JOIN
                  dbo.LES_USER_COMPANY_LINK ON dbo.LES_USERTYPE.USERTYPEID = dbo.LES_USER_COMPANY_LINK.USERTYPEID LEFT OUTER JOIN
                  dbo.LES_APPLICATIONS ON dbo.LES_MODULE.APPLICATIONID = dbo.LES_APPLICATIONS.APPLICATIONID
GO

alter table SHIPMENT_VESSEL_INFO
add VERIFIED_DATE datetime

alter table EPOD_ACCESS_LOG
add VERIFIED_DATE datetime


ALTER VIEW [dbo].[V_DELIVERY_ORDERS_INFO]
AS
SELECT dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.SHIPMENTID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDERS.TRIPID, 
                  dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, dbo.DELIVERY_ORDER_INFO.CONTACT, dbo.DELIVERY_ORDER_INFO.VESSEL_ID, dbo.DELIVERY_ORDER_INFO.VESSEL_ETA, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.POSTING_DATE, dbo.DELIVERY_ORDER_INFO.REQUESTED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.MARK_REFERENCE_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.CUSTOMER_NO, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMER_NAME, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.MAST_VESSEL.IMO_NO, dbo.SHIPMENT.JOBNO, 
                  dbo.Mast_STATUSES.STATUS_DESC, dbo.DELIVERY_ORDERS.STATUSID, dbo.SHIPMENT.ORDER_NO, dbo.DELIVERY_ORDER_INFO.PROMISED_DELIVERY_DATE, dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, 
                  dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDERS.COMPANYID, dbo.DELIVERY_ORDER_INFO.CUSTOMERID, dbo.DELIVERY_ORDER_INFO.CURRENCY_CODE, 
                  dbo.DELIVERY_ORDER_INFO.DO_JOB_NO, dbo.DELIVERY_ORDER_INFO.GOOD_RETURN_REMARKS, dbo.DELIVERY_ORDERS.END_CUSTOMERID, dbo.SM_ADDRESS.ADDR_CODE AS PARENT_CODE, 
                  dbo.SM_ADDRESS.ADDR_NAME AS PARENT_CUSTOMER
FROM     dbo.SM_ADDRESS INNER JOIN
                  dbo.LES_CUSTOMERS ON dbo.SM_ADDRESS.ADDRESSID = dbo.LES_CUSTOMERS.PARENTID RIGHT OUTER JOIN
                  dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID ON 
                  dbo.LES_CUSTOMERS.CUSTOMERID = dbo.DELIVERY_ORDERS.END_CUSTOMERID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO


ALTER VIEW [dbo].[V_DELIVERY_ORDER_LINES]
AS
SELECT dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_LINES_ID, dbo.DELIVERY_ORDER_LINES.ITEM_NO, dbo.DELIVERY_ORDER_LINES.ITEM_REF_NO, dbo.DELIVERY_ORDER_LINES.ITEM_DESCRIPTION, 
                  dbo.DELIVERY_ORDER_LINES.QUANTITY, dbo.DELIVERY_ORDER_LINES.UOM, dbo.DELIVERY_ORDER_LINES.AWB_BL, dbo.DELIVERY_ORDER_LINES.QUANTITY_INVOICED, dbo.DELIVERY_ORDER_LINES.STATUSID, 
                  dbo.DELIVERY_ORDER_LINES.CREATED_DATE, dbo.DELIVERY_ORDER_LINES.UPDATED_DATE, dbo.DELIVERY_ORDER_LINES.GRN_REASON_ID, dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID, 
                  dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.SHIPMENT.JOBNO, dbo.MAST_VESSEL.VESSEL_CODE, 
                  dbo.MAST_VESSEL.VESSEL_NAME, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, 
                  dbo.DELIVERY_ORDER_LINES.EPOD_LINE_REMARKS, dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_CODE, dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_DESCRIPTION, 
                  dbo.SM_ADDRESS.ADDR_CODE AS BROKER_CODE, dbo.SM_ADDRESS.ADDR_NAME AS BROKER_NAME
FROM     dbo.SM_ADDRESS RIGHT OUTER JOIN
                  dbo.LES_CUSTOMERS ON dbo.SM_ADDRESS.ADDRESSID = dbo.LES_CUSTOMERS.BROKERID RIGHT OUTER JOIN
                  dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_LINES ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID ON 
                  dbo.LES_CUSTOMERS.CUSTOMERID = dbo.DELIVERY_ORDERS.END_CUSTOMERID LEFT OUTER JOIN
                  dbo.MAST_GOODS_RETURN_REASONS ON dbo.DELIVERY_ORDER_LINES.GRN_REASON_ID = dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_ID LEFT OUTER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO


--------------------------11-07-2024 Sayak---------------------

ALTER VIEW [dbo].[V_COMPANY_DETAILS]
AS
SELECT dbo.LES_COMPANY.COMPANY_CODE, dbo.LES_COMPANY.COMPANYID, dbo.LES_COMPANY.COMPANY_DESCRIPTION, dbo.LES_COMPANY.LOGOPATH, dbo.LES_COMPANY.ADDRESSID, dbo.LES_USER_COMPANY_LINK.EX_USERID, 
                  dbo.LES_USER_COMPANY_LINK.USERTYPEID, dbo.LES_USERTYPE.USERTYPEDESCR, dbo.LES_USER_COMPANY_LINK.USER_COMPANY_LINK_ID, dbo.LES_COMPANY.MIN_LOGOPATH, dbo.LES_COMPANY.PRINT_LOGO_PATH, 
                  dbo.SM_EXTERNAL_USERS.EX_EMAILID
FROM     dbo.LES_USERTYPE INNER JOIN
                  dbo.LES_USER_COMPANY_LINK ON dbo.LES_USERTYPE.USERTYPEID = dbo.LES_USER_COMPANY_LINK.USERTYPEID INNER JOIN
                  dbo.LES_COMPANY ON dbo.LES_USER_COMPANY_LINK.COMPANYID = dbo.LES_COMPANY.COMPANYID LEFT OUTER JOIN
                  dbo.SM_EXTERNAL_USERS ON dbo.LES_USER_COMPANY_LINK.EX_USERID = dbo.SM_EXTERNAL_USERS.EX_USERID
GO

-------------------------15-07-2024 Raviprasad----------------
//User List
ALTER VIEW [dbo].[V_USER_LIST]
AS
	SELECT 
    users.EX_USERID,
    users.ADDRESSID,
    users.EX_USERCODE,
    users.EX_USERNAME,
    users.EX_EMAILID,
    users.USERTYPE,
    users.CREATED_DATE,
    users.UPDATE_DATE,
    users.COMPANYID,
	Company.COMPANY_CODE,
	Company.COMPANY_DESCRIPTION,
    users.ISACTIVE,
	users.PWD_EXPIRED,
    users.EXPORTED,
    users.DASHBOARD_ACCESS,
    users.ACCESS_LEVEL,
    usertype.USERTYPEDESCR
FROM 
    SM_EXTERNAL_USERS AS users
Inner JOIN 
    LES_USERTYPE AS usertype
	ON 
    users.USERTYPE = usertype.USERTYPEID
Inner JOIN
	LES_COMPANY AS Company 
	ON users.COMPANYID = Company.COMPANYID where users.ISACTIVE=1


// User linked companies
CREATE VIEW V_USERLINKED_COMPANIES AS
SELECT 
    U.EX_USERID, 
    U.EX_USERCODE, 
    UL.COMPANYID, 
    UL.USER_COMPANY_LINK_ID, 
    C.COMPANY_CODE, 
    C.COMPANY_DESCRIPTION,
	T.USERTYPEDESCR
FROM 
    SM_EXTERNAL_USERS AS U
INNER JOIN 
    LES_USER_COMPANY_LINK AS UL ON UL.EX_USERID = U.EX_USERID 
LEFT JOIN 
    LES_COMPANY AS C ON C.COMPANYID = UL.COMPANYID
LEFT JOIN 
	LES_USERTYPE AS T ON T.USERTYPEID=UL.USERTYPEID



------------------------16-07-2024----------------

ALTER VIEW [dbo].[V_DELIVERY_ORDER_LINES]
AS
SELECT dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_LINES_ID, dbo.DELIVERY_ORDER_LINES.ITEM_NO, dbo.DELIVERY_ORDER_LINES.ITEM_REF_NO, dbo.DELIVERY_ORDER_LINES.ITEM_DESCRIPTION, 
                  dbo.DELIVERY_ORDER_LINES.QUANTITY, dbo.DELIVERY_ORDER_LINES.UOM, dbo.DELIVERY_ORDER_LINES.AWB_BL, dbo.DELIVERY_ORDER_LINES.QUANTITY_INVOICED, dbo.DELIVERY_ORDER_LINES.STATUSID, 
                  dbo.DELIVERY_ORDER_LINES.CREATED_DATE, dbo.DELIVERY_ORDER_LINES.UPDATED_DATE, dbo.DELIVERY_ORDER_LINES.GRN_REASON_ID, dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID, 
                  dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.SHIPMENT.JOBNO, dbo.MAST_VESSEL.VESSEL_CODE, 
                  dbo.MAST_VESSEL.VESSEL_NAME, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, 
                  dbo.DELIVERY_ORDER_LINES.EPOD_LINE_REMARKS, dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_CODE, dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_DESCRIPTION, 
                  dbo.SM_ADDRESS.ADDR_CODE AS BROKER_CODE, dbo.SM_ADDRESS.ADDR_NAME AS BROKER_NAME, dbo.DELIVERY_ORDER_INFO.PONO
FROM     dbo.SM_ADDRESS RIGHT OUTER JOIN
                  dbo.LES_CUSTOMERS ON dbo.SM_ADDRESS.ADDRESSID = dbo.LES_CUSTOMERS.BROKERID RIGHT OUTER JOIN
                  dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_LINES ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_LINES.DELIVERY_ORDER_ID ON 
                  dbo.LES_CUSTOMERS.CUSTOMERID = dbo.DELIVERY_ORDERS.END_CUSTOMERID LEFT OUTER JOIN
                  dbo.MAST_GOODS_RETURN_REASONS ON dbo.DELIVERY_ORDER_LINES.GRN_REASON_ID = dbo.MAST_GOODS_RETURN_REASONS.GRN_REASON_ID LEFT OUTER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO



---------------------------22.07.2024------------------------

alter table DELIVERY_ORDER_INFO
add DO_VERIFIED_DATE datetime


ALTER VIEW [dbo].[V_SHIPMENT_DELIVERY_ORDERS]
AS
SELECT dbo.SHIPMENT.SHIPMENTID, dbo.SHIPMENT.ORDER_NO, dbo.SHIPMENT.JOBNO, Mast_STATUSES_1.STATUS_DESC AS SHIPMENT_STATUS_DESC, dbo.Mast_STATUSES.STATUS_DESC AS DO_STATUS_DESC, 
                  dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.TRIPID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, 
                  dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.DO_VERIFIED_DATE
FROM     dbo.SHIPMENT INNER JOIN
                  dbo.DELIVERY_ORDERS ON dbo.SHIPMENT.SHIPMENTID = dbo.DELIVERY_ORDERS.SHIPMENTID INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.Mast_STATUSES AS Mast_STATUSES_1 ON dbo.SHIPMENT.SHIPMENT_STATUSID = Mast_STATUSES_1.STATUSID
GO

---------------------------24.07.2024------------------------

CREATE TABLE [dbo].[PACKING_INFO](
	[PACKING_INFO_ID] [int] IDENTITY(1000,1) NOT NULL,
	[DELIVERY_ORDER_ID] [int] NULL,
	[PACKING_INFO] [nvarchar](500) NULL,
 CONSTRAINT [PK_PACKING_INFO] PRIMARY KEY CLUSTERED 
(
	[PACKING_INFO_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[PACKING_INFO]  WITH CHECK ADD FOREIGN KEY([DELIVERY_ORDER_ID])
REFERENCES [dbo].[DELIVERY_ORDERS] ([DELIVERY_ORDER_ID])
GO


alter table DELIVERY_ORDER_LINES
ADD FOREIGN KEY (DELIVERY_ORDER_ID) REFERENCES DELIVERY_ORDERS(DELIVERY_ORDER_ID);

alter table DELIVERY_ORDER_INFO
ADD FOREIGN KEY (DELIVERY_ORDER_ID) REFERENCES DELIVERY_ORDERS(DELIVERY_ORDER_ID);

alter table DELIVERY_ORDER_DOCUMENTS
ADD FOREIGN KEY (DELIVERY_ORDER_ID) REFERENCES DELIVERY_ORDERS(DELIVERY_ORDER_ID);

alter table SHIPMENT_VESSEL_INFO
ADD FOREIGN KEY (SHIPMENTID) REFERENCES SHIPMENT(SHIPMENTID);

-----------------------------------------29-07-2024---------------------------------

ALTER VIEW [dbo].[V_DELIVERY_ORDERS_INFO]
AS
SELECT dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID, dbo.DELIVERY_ORDERS.DELIVERY_ORDER_NO, dbo.DELIVERY_ORDERS.SHIPMENTID, dbo.DELIVERY_ORDERS.TRIPDETAILID, dbo.DELIVERY_ORDERS.TRIPID, 
                  dbo.DELIVERY_ORDER_INFO.SALES_ORDER_NO, dbo.DELIVERY_ORDER_INFO.QUOTE_NO, dbo.DELIVERY_ORDER_INFO.CONTACT, dbo.DELIVERY_ORDER_INFO.VESSEL_ID, dbo.DELIVERY_ORDER_INFO.VESSEL_ETA, 
                  dbo.DELIVERY_ORDER_INFO.DEPT_CODE, dbo.DELIVERY_ORDER_INFO.SALES_PERSON_CODE, dbo.DELIVERY_ORDER_INFO.POSTING_DATE, dbo.DELIVERY_ORDER_INFO.REQUESTED_DELIVERY_DATE, 
                  dbo.DELIVERY_ORDER_INFO.INTERNAL_DEPT, dbo.DELIVERY_ORDER_INFO.MARK_REFERENCE_NO, dbo.DELIVERY_ORDER_INFO.PONO, dbo.DELIVERY_ORDER_INFO.CUSTOMER_NO, 
                  dbo.DELIVERY_ORDER_INFO.CUSTOMER_NAME, dbo.SHIPMENT.PLANNED_SHIP_DATE, dbo.MAST_VESSEL.VESSEL_CODE, dbo.MAST_VESSEL.VESSEL_NAME, dbo.MAST_VESSEL.IMO_NO, dbo.SHIPMENT.JOBNO, 
                  dbo.Mast_STATUSES.STATUS_DESC, dbo.DELIVERY_ORDERS.STATUSID, dbo.SHIPMENT.ORDER_NO, dbo.DELIVERY_ORDER_INFO.PROMISED_DELIVERY_DATE, dbo.DELIVERY_ORDER_INFO.PACKAGING_UNIT_NO, 
                  dbo.DELIVERY_ORDER_INFO.AGENT_SERVICE, dbo.DELIVERY_ORDER_INFO.LOCATION_CODE, dbo.DELIVERY_ORDERS.COMPANYID, dbo.DELIVERY_ORDER_INFO.CUSTOMERID, dbo.DELIVERY_ORDER_INFO.CURRENCY_CODE, 
                  dbo.DELIVERY_ORDER_INFO.DO_JOB_NO, dbo.DELIVERY_ORDER_INFO.GOOD_RETURN_REMARKS, dbo.DELIVERY_ORDERS.END_CUSTOMERID, dbo.SM_ADDRESS.ADDR_CODE AS PARENT_CODE, 
                  dbo.SM_ADDRESS.ADDR_NAME AS PARENT_CUSTOMER, dbo.DELIVERY_ORDER_INFO.ShipmentDate, dbo.DELIVERY_ORDER_INFO.PlannedDeliveryDate, dbo.DELIVERY_ORDER_INFO.plannedShipmentDate, 
                  dbo.DELIVERY_ORDER_INFO.DO_VERIFIED_DATE
FROM     dbo.SM_ADDRESS INNER JOIN
                  dbo.LES_CUSTOMERS ON dbo.SM_ADDRESS.ADDRESSID = dbo.LES_CUSTOMERS.PARENTID RIGHT OUTER JOIN
                  dbo.DELIVERY_ORDERS INNER JOIN
                  dbo.DELIVERY_ORDER_INFO ON dbo.DELIVERY_ORDERS.DELIVERY_ORDER_ID = dbo.DELIVERY_ORDER_INFO.DELIVERY_ORDER_ID ON 
                  dbo.LES_CUSTOMERS.CUSTOMERID = dbo.DELIVERY_ORDERS.END_CUSTOMERID LEFT OUTER JOIN
                  dbo.Mast_STATUSES ON dbo.DELIVERY_ORDERS.STATUSID = dbo.Mast_STATUSES.STATUSID LEFT OUTER JOIN
                  dbo.MAST_VESSEL ON dbo.DELIVERY_ORDER_INFO.VESSEL_ID = dbo.MAST_VESSEL.VESSEL_ID LEFT OUTER JOIN
                  dbo.SHIPMENT ON dbo.DELIVERY_ORDERS.SHIPMENTID = dbo.SHIPMENT.SHIPMENTID
GO

-----------------------------------------01-08-2024---------------------------------

ALTER VIEW [dbo].[V_USER_LIST]
AS
SELECT 
    users.EX_USERID,
    users.ADDRESSID,
    users.EX_USERCODE,
    users.EX_USERNAME,
	users.EX_PASSWORD,
    users.EX_EMAILID,
    users.USERTYPE,
    users.CREATED_DATE,
    users.UPDATE_DATE,
    users.COMPANYID,
	Company.COMPANY_CODE,
	Company.COMPANY_DESCRIPTION,
    users.ISACTIVE,
	users.PWD_EXPIRED,
    users.EXPORTED,
    users.DASHBOARD_ACCESS,
    users.ACCESS_LEVEL,
    usertype.USERTYPEDESCR
FROM 
    SM_EXTERNAL_USERS AS users
Inner JOIN 
    LES_USERTYPE AS usertype
	ON 
    users.USERTYPE = usertype.USERTYPEID
Inner JOIN
	LES_COMPANY AS Company 
	ON users.COMPANYID = Company.COMPANYID
GO

-------------------------------------------06-08-2024-------------------------------------
CREATE VIEW [dbo].[V_USERTYPE_MODULE_ACCESS]
AS
SELECT MODULEACCESSID, ROW_NUMBER() over(order by USERTYPEMODULES.USERTYPEID) AS RowNumber, ACCESS_LEVEL,CASE ACCESS_LEVEL WHEN '0' THEN 'No Access' WHEN '1' THEN 'ReadOnly' WHEN '2' THEN 'Add/Update' WHEN '3' THEN 'Full Access' END AS ACCESS_VALUE_TEXT ,USERTYPEMODULES.USERTYPEID,USERTYPEMODULES.USERTYPEDESCR, USERTYPEMODULES.ModuleID,USERTYPEMODULES.Module_Desc FROM LES_USERTYPE_MODULE_ACCESS RIGHT JOIN 
(SELECT T.USERTYPEID,T.USERTYPEDESCR,M.MODULEID, M.Module_Desc FROM [LES_USERTYPE] AS T, LES_MODULE AS M) USERTYPEMODULES 
 ON USERTYPEMODULES.USERTYPEID=LES_USERTYPE_MODULE_ACCESS.USERTYPEID AND USERTYPEMODULES.ModuleID=LES_USERTYPE_MODULE_ACCESS.MODULEID

-------------------------------------------27-09-2024-------------------------------------

DATABASE: LES_USER_ADMINISTRATION 


ALTER TABLE SM_EXTERNAL_USERS ADD MAIL_NOTIFICATION INT NULL



ALTER VIEW [dbo].[V_USER_LIST]
AS
SELECT 
    users.EX_USERID,
    users.ADDRESSID,
    users.EX_USERCODE,
    users.EX_USERNAME,
	users.EX_PASSWORD,
    users.EX_EMAILID,
    users.USERTYPE,
    users.CREATED_DATE,
    users.UPDATE_DATE,
    users.COMPANYID,
	users.MAIL_NOTIFICATION,
	Company.COMPANY_CODE,
	Company.COMPANY_DESCRIPTION,
    users.ISACTIVE,
	users.PWD_EXPIRED,
    users.EXPORTED,
    users.DASHBOARD_ACCESS,
    users.ACCESS_LEVEL,
    usertype.USERTYPEDESCR
FROM 
    SM_EXTERNAL_USERS AS users
Inner JOIN 
    LES_USERTYPE AS usertype
	ON 
    users.USERTYPE = usertype.USERTYPEID
Inner JOIN
	LES_COMPANY AS Company 
	ON users.COMPANYID = Company.COMPANYID
GO

ALTER view [dbo].[V_COMPANY_DETAILS] As 
SELECT 
    ROW_NUMBER() OVER (ORDER BY dbo.LES_COMPANY.COMPANYID) AS ROWNO,
    dbo.LES_COMPANY.COMPANY_CODE,
    dbo.LES_COMPANY.COMPANYID,
    dbo.LES_COMPANY.COMPANY_DESCRIPTION,
    dbo.LES_COMPANY.LOGOPATH,
    dbo.LES_COMPANY.ADDRESSID,
    dbo.LES_USER_COMPANY_LINK.EX_USERID,
    dbo.LES_USER_COMPANY_LINK.USERTYPEID,
    dbo.LES_USERTYPE.USERTYPEDESCR,
    dbo.LES_USER_COMPANY_LINK.USER_COMPANY_LINK_ID,
    dbo.LES_COMPANY.MIN_LOGOPATH,
    dbo.LES_COMPANY.PRINT_LOGO_PATH,
    dbo.SM_EXTERNAL_USERS.EX_EMAILID,
	dbo.SM_EXTERNAL_USERS.MAIL_NOTIFICATION
FROM 
    dbo.LES_USERTYPE 
INNER JOIN 
    dbo.LES_USER_COMPANY_LINK 
    ON dbo.LES_USERTYPE.USERTYPEID = dbo.LES_USER_COMPANY_LINK.USERTYPEID 
RIGHT OUTER JOIN 
    dbo.LES_COMPANY 
    ON dbo.LES_USER_COMPANY_LINK.COMPANYID = dbo.LES_COMPANY.COMPANYID 
LEFT OUTER JOIN 
    dbo.SM_EXTERNAL_USERS 
    ON dbo.LES_USER_COMPANY_LINK.EX_USERID = dbo.SM_EXTERNAL_USERS.EX_USERID;
GO

